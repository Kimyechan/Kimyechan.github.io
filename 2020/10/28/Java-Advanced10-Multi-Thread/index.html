
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Java Server Developer">
    <title>Java-Advanced10-Multi Thread - Java Server Developer</title>
    <meta name="author" content="Yechan Kim">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Yechan Kim","sameAs":["https://github.com/","http://stackoverflow.com/users","https://twitter.com/","https://facebook.com/","https://plus.google.com/","https://www.linkedin.com/profile/","mailto"]},"articleBody":"Multi-Thread ProgrammingProcess and Thread\nProcess: OS로부터 메모리를 할당받아 실행중인 프로그램\nThread: 프로세스 동작의 최소 단위로, 하나의 프로세스는 여러 스레드로 이루어질 수 있다.\n\n멀티스레드 프로그래밍의 장단점\n장점\n여러 동작을 병렬적으로 처리하여 CPU의 사용률 향상\n시간이 걸리는 동작을 분리하여 프로그램의 응답성 향상\n\n\n단점\nContext Switching 오버헤드 발생\n스레드 제어의 어려움\n\n\n\n스레드 구현\n스레드 생성 방법\n\n익명함수\n 12345Thread threadOne = new Thread(new Runnable() &#123;    public void run() &#123;        System.out.println(&quot;Hello Thread!&quot;);    &#125;&#125;);\n람다식\n 123Thread threadTwo = new Thread(() -&gt; &#123;    System.out.println(&quot;Hello Again, Thread!&quot;);&#125;);\n\nThread Class 상속\n 123456class MyThread extends Thread &#123;    public void run() &#123;        System.out.println(&quot;Hello Again Again, Thread!&quot;);    &#125;&#125;Thread threadThree = new MyThread();\n\n\n\n스레드 실행\n123456789101112131415Thread threadOne = new Thread(() -&gt; &#123;    for (int i = 0; i &lt; 10; i++) &#123;        System.out.print(&quot;1&quot;);    &#125;&#125;);Thread threadTwo = new Thread(() -&gt; &#123;    for (int i = 0; i &lt; 10; i++) &#123;        System.out.print(&quot;2&quot;);    &#125;&#125;);threadOne.start();threadTwo.start();System.out.println(&quot;Done!&quot;);\nThread 객체는 일회성이기 때문에 여러 번 start()메소드를 호출 할 수 없다\n\n\n\n\n스레드의 상태 및 제어\n스레드의 상태\n\ngetState() 메소드로 스레드의 상태를 확인할 수 있다.\n\n\n\n열거형 상수\n설명\n\n\n\nNEW\nstart() 메소드가 아직 호출되지 않음\n\n\nRUNNABLE\nJVM에 의해 실행 가능한 상태\n\n\nBLOCKED\n객체가 블락된 상태\n\n\nWAITING\nsleep(), wait(), join() 등에 의해 무한히 대기 중인 상태\n\n\nTIMED_WAITING\nsleep(), wait(), join() 등에 의해 정해진 시간 동안 대기 중인 상태\n\n\nTERMINATE\nrun() 메소드가 종료된 상태\n\n\n\n\n\n스레드의 우선순위 제어\n123public final static int MIN_PRIORITY = 1;public final static int NORM_PRIORITY = 5;public final static int MAX_PRIORITY = 10;\n\n\n\n\n메소드\n설명\n\n\n\nvoid setPriority(int newPriority)\n새로운 우선순위로 설정한다.\n\n\nint getPriority()\n우선순위를 반환한다.\n\n\n\nsleep()을 이용한 제어\n12Thread.sleep(1000); // msThread.sleep(100, 200); // ms + ns\n\njoin()을 이용한 스레드 조인\n\n스레드 동작을 동기화하기 위해 사용\n123456789101112Thread t1 = new Thread(() -&gt; System.out.println(&quot;A&quot;));Thread t2 = new Thread(() -&gt; System.out.println(&quot;B&quot;));t1.start(); // t1 thread startt1.join(); // t1 thread 종료시 까지 다른 thread 대기t2.start(); // t2 thread startt2.join(100); // 100ms 기다린 후에도 t2가 종료되지 않으면 다른 쓰레드 시작 System.out.println(&quot;C&quot;);\n\n\n\ninterrupt()를 이용한 대기 중지\n\n기존 동작을 방해하고 반응을 강제하는 메소드1234567891011121314151617Thread tSleep = new Thread(() -&gt; &#123;    try &#123;        Thread.sleep(1000);    &#125; catch (InterruptedException e) &#123;        System.out.println(&quot;Interrupted&quot;);    &#125;&#125;);tSleep.start();try &#123;    Thread.sleep(500);&#125; catch (InterruptedException e) &#123;    e.printStackTrace();&#125;tSleep.interrupt();\n\n\n\nyield()를 이용한 상태 제어\n\nsleep()과 달리 곧바로 RUNNABLE 상태로 변경\n다른 쓰레드에게 양보하고 바로 실행 대기\n테스트용으로 쓰임 -&gt; 쓰레드의 동작이 명확하지 않음(바로 양보하지 않는다)12345678910111213141516171819new Thread(() -&gt; &#123;    for (int i = 0; i &lt; 20; i++) &#123;        if (i % 2 == 0) &#123;            System.out.print(&quot;1&quot;);        &#125; else &#123;            Thread.yield();        &#125;    &#125;&#125;).start();new Thread(() -&gt; &#123;    for (int i = 0; i &lt; 20; i++) &#123;        if (i % 2 == 0) &#123;            System.out.print(&quot;2&quot;);        &#125; else &#123;            Thread.yield();        &#125;    &#125;&#125;).start();\n\n\n\n스레드의 종료\n\nrun() 메소드의 종료\nstop() 메소드 호출 (deprecated)\n\n\n\n데몬 스레드\n정의 : 다른 스레드가 종료될 경우 함께 종료되는 보조 스레드\n\n활용법\n\n보통 대기하며 동작하는 무한 루프로 구현\n일정 시간 마다 동작\ninterrupt에 의해서 동작\n\n\nsetDaemon() 메소드로 데몬 스레드로 설정\n1234567891011121314151617class DaemonThread extends Thread &#123;    public DaemonThread() &#123;        this.setDaemon(true);    &#125;    @Override    public void run() &#123;        while (true) &#123;            try &#123;                Thread.sleep(1000);            &#125; catch (InterruptedException e) &#123;                e.printStackTrace();            &#125;            System.out.println(&quot;Daemon Thread Run&quot;);        &#125;    &#125;&#125;\n\n\n\n데이터 공유와 동기화\n스레드간 데이터 공유 시 신뢰성에 문제가 발생할 수 있음\n  결과는 1000000이 나오지 않는다 -&gt; count값이 동기화되지 않았기 때문\n  123456789101112131415161718192021222324class Counter &#123;        int count = 0;&#125;public class Main &#123;    public static void main(String args[])&#123;        Counter counter = new Counter();        for (int i = 0; i &lt; 1000; i++) &#123;            new Thread(() -&gt; &#123;                for (int j = 0; j &lt; 1000; j++) &#123;                    counter.count = counter.count + 1;                &#125;            &#125;).start();        &#125;        try &#123;            Thread.sleep(1000);        &#125; catch (InterruptedException e) &#123;            e.printStackTrace();        &#125;        System.out.println(counter.count);    &#125;&#125;\n\nsynchronized 키워드 사용\n123synchronized void method() &#123;    // 공유 데이터 사용&#125;\n\n12345void method() &#123;    synchronized(sharedObj) &#123;        // 공유 데이터 사용    &#125;&#125;\n\nExample\n\nthis 객체의 Intrinsic Lock을 이용한 구현\n  123456789101112class Counter &#123;    private int count = 0;    public int increaseCount() &#123;        synchronized (this) &#123;            return ++count; // 읽고, 수정하고, 쓰는 작업        &#125;    &#125;    public int getCount() &#123;        return count;    &#125;&#125;\n\n메소드에 synchronized 키워드 사용\n\nsynchronized 키워드가 사용된 메소드를 호출하기 위해서는 해당 객체를 소유해야만 호출이 가능. 소유하지 못하면 Blocking12345678910class Counter &#123;    private int count = 0;    public synchronized int increaseCount() &#123;        return ++count; // 읽고, 수정하고, 쓰는 작업    &#125;    public int getCount() &#123;        return count;    &#125;&#125;\n\n\n\n\n\n\nwait(), notify(), notifyAll()\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162class WorkObject &#123;      public synchronized void methodA() &#123;          System.out.println(&quot;ThreadA의 methodA() 작업 실행&quot;);          notify(); // 일시정지 상태에 있는 ThreadB를 실행 대기상태로 만듬           try &#123;              wait(); // ThreadA를 일시 정지 상태로 만듬           &#125; catch (InterruptedException e) &#123;              e.printStackTrace();          &#125;      &#125;        public synchronized void methodB() &#123;          System.out.println(&quot;ThreadB의 methodB() 작업 실행&quot;);          notify(); // 일시정지 상태에 있는 ThreadA를 실행 대기상태로 만듬          try &#123;              wait(); // ThreadB를 일시 정지 상태로 만듬          &#125; catch (InterruptedException e) &#123;              e.printStackTrace();          &#125;      &#125;  &#125;    class ThreadA extends Thread &#123;      private WorkObject workObject;      ThreadA(WorkObject workObject) &#123;          this.workObject = workObject;      &#125;            public void run() &#123;          for(int i=0; i&lt;10; i++) &#123;              workObject.methodA(); // 공유객체의 methodA를 반복적으로 호출           &#125;      &#125;  &#125;  class ThreadB extends Thread&#123;      private WorkObject workObject;      ThreadB(WorkObject workObject) &#123;          this.workObject = workObject;      &#125;            public void run() &#123;          for(int i=0; i&lt;10; i++) &#123;              workObject.methodB(); // 공유객체의 methodA를 반복적으로 호출           &#125;      &#125;  &#125;  class Main &#123;      public static void main(String[] args) &#123;          WorkObject sharedObject = new WorkObject();                    ThreadA threadA = new ThreadA(sharedObject);          ThreadB threadB = new ThreadB(sharedObject);                    threadA.start();          threadB.start();      &#125;&#125;\n\n\n\n세마포어\n사전적 의미 : 횟대(깃발)\n\nn개의 깃발을 놓고, 여러 스레드가 경쟁하도록 하는 sync 기법\n\nn = 1이면, BinarySemaphore라고 하며, Lock과 유사하게 동작\n\n메소드\n\nrelease(int permits) : permits만큼의 자원 개수 반환\nacquire(int permits) : permits만큼의 자원 사용 (Blocking O)\ntryAcquire(long timeout, TimeUnit unit) : unit단위의 timeout이후 자원을 얻지 못하면 false, 얻으면 true (Blocking X)\nacquireUninterruptibly() : 자원을 얻지못해도 interrupt 발생 X\n\n\nExample\n  12345678910111213141516171819202122232425public class Main &#123;    public static void main(String[] args) &#123;        Semaphore sem = new Semaphore(1);        sem.release(10);        sem.tryAcquire();        System.out.println(sem.availablePermits());        try &#123; // Blocking으로 동작            sem.acquire(12);        &#125; catch (InterruptedException e) &#123;            e.printStackTrace();        &#125;        sem.acquireUninterruptibly(); // interrupt에 반응하지 않음        try &#123;            System.out.println(sem.tryAcquire(100, TimeUnit.MILLISECONDS)); // Blocking 하지 않고, 실패하면 false        &#125; catch (InterruptedException e) &#123;            e.printStackTrace();        &#125;        sem.release();        System.out.println(sem.availablePermits());    &#125;&#125;  \n\nDining Philosopher (식사하는 철학자)\n  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071class Philosopher extends Thread &#123;    private final int id;    private final Fork left;    private final Fork right;    public Philosopher(int id, Fork left, Fork right) &#123;        this.id = id;        this.left = left;        this.right = right;    &#125;    @Override    public void run() &#123;        while (true) &#123;            try &#123;                left.acquire();                System.out.println(id + &quot;: left taken&quot;);            &#125; catch (InterruptedException e) &#123;                e.printStackTrace();            &#125;            try &#123;                if(!right.tryAcquire(1000, TimeUnit.MILLISECONDS))&#123;                    left.release();                    Thread.yield();                    continue;                &#125;                System.out.println(id + &quot;: right taken&quot;);            &#125; catch (InterruptedException e) &#123;                e.printStackTrace();            &#125;            try &#123;                Thread.sleep(2000);                System.out.println(id + &quot;is eating&quot;);            &#125; catch (InterruptedException e) &#123;                e.printStackTrace();            &#125;            left.release();            right.release();            Thread.yield();        &#125;    &#125;&#125;class Fork extends Semaphore &#123;    public Fork() &#123;        super(1);    &#125;&#125;public class Main &#123;    public static void main(String[] args) &#123;        Philosopher[] phils = new Philosopher[5];        Fork[] forks = new Fork[5];        for (int i = 0; i &lt; 5; i++) &#123;            forks[i] = new Fork();        &#125;        for (int i = 0; i &lt; 5 - 1; i++) &#123;            phils[i] = new Philosopher(i, forks[i], forks[(i+1) % 5]);        &#125;        phils[4] = new Philosopher(4, forks[0], forks[4]);        for (int i = 0; i &lt; 5; i++)&#123;            phils[i].start();        &#125;    &#125;&#125;\n\n\n\nJCF와 Thread\nVector VS List\n\nList   \n메소드들이 Synchronized 되지 않음\n속도는 빠르다.\n\n\nVector \n메소드들이 Synchronized 되어 있음\n속도는 느리다.\n\n\n\n\nList를 Synchronized 되게 하는 방법\n\nCollections의 synchronizedList() 사용  12List&lt;Integer&gt; list1 = new ArrayList&lt;&gt;();List&lt;Integer&gt; list2 = Collections.synchronizedList(list1);\nThread Pool\n\n\nThread Pool이란?\n\n미리 생성해 둔 Thread의 집합을 스레드 풀이라고 한다.\n미리 Thread를 생성해 두고, 작업만 Thread에 할당하여 동작\n사용 이유\nThread를 직접 만들어 사용할 경우, Multi-Thread 작업을 계속 할 때, Thread 생성/삭제 오버해드가 크다.\n배치작업 (모아두고 한 번에 처리하는 작업)에 유용하여 많이 사용된다.\n\n\n\n\nThread Pool 생성 \n\nSingle Thread Pool\n  1ExecutorService pool = Executors.newSingleThreadExecutor();\n\nThread가 1개인 ThreadPool 생성(SingleThread)\n실패 시, 새로운 Thread를 생성하지 않음\n\n\nCached Thread Pool\n  1ExecutorService pool = Executors.newCachedThreadPool();\n\n초기 Thread 0개\n코어 Thread 0개 (일하지 않아도 종료시키지 않는 Thread)\n요청 작업보다 Thead가 부족하면 새 스레드 생성\n60초동안 일하지 않는 Thread 제거\n\n\nFixed Thread Pool\n  1ExecutorService pool = Executors.newFixedThreadPool(int nThreads);\n\n최대 Thread nThreads개\n코어 Thread nThreads개\n작업하지 않는 Thread도 제거하지 않고 동작\n\n\nScheduler Thread Pool\n  1ScheduledExecutorService pool = Executors.newScheduledThreadPool(int corePoolSize);\n\n지정된 delay후에 실행하도록함(주기적으로 실행하는 명령을 예약)\n\n\n\n\n작업 생성과 처리 요청\n\n작업 생성\n\nRunnable 구현 클래스\n  123456Runnable task = new Runnable()&#123;    @Override    public void run()&#123;        // 작업 내용    &#125;&#125;\n\nCallable 구현 클래스\n  1234567Callable&lt;T&gt; task = new Callable&lt;T&gt;()&#123;    @Override    public T call() throws Exception&#123;        // 작업 내용        return T;&#125;\n  Runnable run()은 Return 값이 없고, Callable call()은 Return 값이 있음\n\n\n\n처리 요청\n\n매소드 \n\n\n\n리턴 타입\n메소드\n설명\n\n\n\nvoid\nexecute(Runnable command)\nRunnable을 작업 큐에 저장, 작업 처리 결과를 받지 못함\n\n\nFuture&lt;?&gt;\nsubmit(Runnable task)\nRunnable 작업 큐에 저장, 리턴된 Future를 통해 작업 처리 결과를 얻을 수 있음\n\n\nFuture\nsubmit(Runnable task, V result)\nRunnable 작업 큐에 저장, 리턴된 Future를 통해 작업 처리 결과를 얻을 수 있음\n\n\nFuture\nsubmit(Callable task)\nCallable 작업 큐에 저장, 리턴된 Future를 통해 작업 처리 결과를 얻을 수 있음\n\n\n\nexecute()\n\n작업 처리 결과를 반환하지 않는다.\n\n작업 처리 도중 예외가 발생하면 스레드가 종료되고 해당 스레드는 스레드 풀에서 제거된다. \n\n다른 작업을 처리하기 위해 새로운 스레드를 생성한다.\n\n\n\nsubmit()\n\n작업 처리 결과를 반환한다.\n\n작업 처리 도중 예외가 발생하더라도 스레드는 종료되지 않고 다음 작업을 위해 재사용\n\n스레드의 생성 오버헤드를 방지하기 위해서라도 submit() 을 가급적 사용한다.\n\n\n\n\n\n\n\n\n\nThread Pool 종료\n\nThread Pool에 속한 Thread는 데몬 스레드가 아니다\n\n\n따라서 주 스레드 종료시 강제종료 되지 않기 때문에 main 스레드가 종료되어도 실행상태가 유지된다.\n\n\n어플리케이션을 종료하기 위해서는 스레드 풀을 강제종료시켜야 한다.\n\n\nexcutorService.shutdown()\n  작업큐에 남아있는 작업까지 모두 마무리 후 종료 (오버헤드를 줄이기 위해 일반적으로 많이 사용.)\n\nexcutorService.shoutdownNow()\n  작업큐 작업 잔량 상관없이 강제 종료\n\nexcutorService.awaitTermination(long timeout, TimeUnit unit)\n  모든 작업 처리를 timeout 시간안에 처리하면 true 리턴 ,처리하지 못하면 작업스레드들을 interrupt()시키고 false리턴\n\n\n\n\n","dateCreated":"2020-10-28T19:23:05+09:00","dateModified":"2020-10-30T18:27:21+09:00","datePublished":"2020-10-28T19:23:05+09:00","description":"","headline":"Java-Advanced10-Multi Thread","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://kimyechan.github.io/2020/10/28/Java-Advanced10-Multi-Thread/"},"publisher":{"@type":"Organization","name":"Yechan Kim","sameAs":["https://github.com/","http://stackoverflow.com/users","https://twitter.com/","https://facebook.com/","https://plus.google.com/","https://www.linkedin.com/profile/","mailto"]},"url":"https://kimyechan.github.io/2020/10/28/Java-Advanced10-Multi-Thread/","keywords":"Java"}</script>
    <meta name="description" content="Multi-Thread ProgrammingProcess and Thread Process: OS로부터 메모리를 할당받아 실행중인 프로그램 Thread: 프로세스 동작의 최소 단위로, 하나의 프로세스는 여러 스레드로 이루어질 수 있다.  멀티스레드 프로그래밍의 장단점 장점 여러 동작을 병렬적으로 처리하여 CPU의 사용률 향상 시간이 걸리는 동작을 분리하여">
<meta property="og:type" content="blog">
<meta property="og:title" content="Java-Advanced10-Multi Thread">
<meta property="og:url" content="https://kimyechan.github.io/2020/10/28/Java-Advanced10-Multi-Thread/index.html">
<meta property="og:site_name" content="Java Server Developer">
<meta property="og:description" content="Multi-Thread ProgrammingProcess and Thread Process: OS로부터 메모리를 할당받아 실행중인 프로그램 Thread: 프로세스 동작의 최소 단위로, 하나의 프로세스는 여러 스레드로 이루어질 수 있다.  멀티스레드 프로그래밍의 장단점 장점 여러 동작을 병렬적으로 처리하여 CPU의 사용률 향상 시간이 걸리는 동작을 분리하여">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-10-28T10:23:05.000Z">
<meta property="article:modified_time" content="2020-10-30T09:27:21.034Z">
<meta property="article:author" content="Yechan Kim">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/all.css">

    
<link rel="stylesheet" href="/assets/css/jquery.fancybox.css">

    
<link rel="stylesheet" href="/assets/css/thumbs.css">

    
<link rel="stylesheet" href="/assets/css/tranquilpeak.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Java Server Developer
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="Search"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="http://stackoverflow.com/users"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Stack Overflow"
                        >
                        <i class="sidebar-button-icon fab fa-stack-overflow" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Stack Overflow</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://twitter.com/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Twitter"
                        >
                        <i class="sidebar-button-icon fab fa-twitter" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Twitter</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://facebook.com/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Facebook"
                        >
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://plus.google.com/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Google +"
                        >
                        <i class="sidebar-button-icon fab fa-google-plus" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Google +</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/profile/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/mailto"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            Java-Advanced10-Multi Thread
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2020-10-28T19:23:05+09:00">
	
		    Oct 28, 2020
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Java/">Java</a>, <a class="category-link" href="/categories/Java/Java-Advanced/">Java Advanced</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h1 id="Multi-Thread-Programming"><a href="#Multi-Thread-Programming" class="headerlink" title="Multi-Thread Programming"></a>Multi-Thread Programming</h1><h2 id="Process-and-Thread"><a href="#Process-and-Thread" class="headerlink" title="Process and Thread"></a>Process and Thread</h2><ul>
<li>Process: OS로부터 메모리를 할당받아 실행중인 프로그램</li>
<li>Thread: 프로세스 동작의 최소 단위로, 하나의 프로세스는 여러 스레드로 이루어질 수 있다.</li>
</ul>
<h2 id="멀티스레드-프로그래밍의-장단점"><a href="#멀티스레드-프로그래밍의-장단점" class="headerlink" title="멀티스레드 프로그래밍의 장단점"></a>멀티스레드 프로그래밍의 장단점</h2><ul>
<li>장점<ul>
<li>여러 동작을 병렬적으로 처리하여 CPU의 사용률 향상</li>
<li>시간이 걸리는 동작을 분리하여 프로그램의 응답성 향상</li>
</ul>
</li>
<li>단점<ul>
<li>Context Switching 오버헤드 발생</li>
<li>스레드 제어의 어려움</li>
</ul>
</li>
</ul>
<h2 id="스레드-구현"><a href="#스레드-구현" class="headerlink" title="스레드 구현"></a>스레드 구현</h2><ul>
<li><p>스레드 생성 방법</p>
<ol>
<li><p>익명함수</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Thread threadOne = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello Thread!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li><p>람다식</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Thread threadTwo = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Hello Again, Thread!&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Thread Class 상속</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello Again Again, Thread!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Thread threadThree = <span class="keyword">new</span> MyThread();</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>스레드 실행</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Thread threadOne = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        System.out.print(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Thread threadTwo = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        System.out.print(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">threadOne.start();</span><br><span class="line">threadTwo.start();</span><br><span class="line">System.out.println(<span class="string">&quot;Done!&quot;</span>);</span><br></pre></td></tr></table></figure>
<p><code>Thread 객체는 일회성이기 때문에 여러 번 start()메소드를 호출 할 수 없다</code></p>
<br>

</li>
</ul>
<h2 id="스레드의-상태-및-제어"><a href="#스레드의-상태-및-제어" class="headerlink" title="스레드의 상태 및 제어"></a>스레드의 상태 및 제어</h2><ul>
<li><p>스레드의 상태</p>
<ul>
<li><p>getState() 메소드로 스레드의 상태를 확인할 수 있다.</p>
<table>
<thead>
<tr>
<th>열거형 상수</th>
<th>설명</th>
</tr>
</thead>
<tbody><tr>
<td><code>NEW</code></td>
<td><code>start()</code> 메소드가 아직 호출되지 않음</td>
</tr>
<tr>
<td><code>RUNNABLE</code></td>
<td>JVM에 의해 실행 가능한 상태</td>
</tr>
<tr>
<td><code>BLOCKED</code></td>
<td>객체가 블락된 상태</td>
</tr>
<tr>
<td><code>WAITING</code></td>
<td><code>sleep()</code>, <code>wait()</code>, <code>join()</code> 등에 의해 무한히 대기 중인 상태</td>
</tr>
<tr>
<td><code>TIMED_WAITING</code></td>
<td><code>sleep()</code>, <code>wait()</code>, <code>join()</code> 등에 의해 정해진 시간 동안 대기 중인 상태</td>
</tr>
<tr>
<td><code>TERMINATE</code></td>
<td><code>run()</code> 메소드가 종료된 상태</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
<li><p>스레드의 우선순위 제어</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> MIN_PRIORITY = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> NORM_PRIORITY = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> MAX_PRIORITY = <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>메소드</th>
<th>설명</th>
</tr>
</thead>
<tbody><tr>
<td><code>void setPriority(int newPriority)</code></td>
<td>새로운 우선순위로 설정한다.</td>
</tr>
<tr>
<td><code>int getPriority()</code></td>
<td>우선순위를 반환한다.</td>
</tr>
</tbody></table>
</li>
<li><p><code>sleep()</code>을 이용한 제어</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Thread.sleep(<span class="number">1000</span>); <span class="comment">// ms</span></span><br><span class="line">Thread.sleep(<span class="number">100</span>, <span class="number">200</span>); <span class="comment">// ms + ns</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>join()</code>을 이용한 스레드 조인</p>
<ul>
<li><p>스레드 동작을 동기화하기 위해 사용</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Thread t1 = <span class="keyword">new</span> Thread(() -&gt; System.out.println(<span class="string">&quot;A&quot;</span>));</span><br><span class="line">Thread t2 = <span class="keyword">new</span> Thread(() -&gt; System.out.println(<span class="string">&quot;B&quot;</span>));</span><br><span class="line"></span><br><span class="line">t1.start(); <span class="comment">// t1 thread start</span></span><br><span class="line"></span><br><span class="line">t1.join(); <span class="comment">// t1 thread 종료시 까지 다른 thread 대기</span></span><br><span class="line"></span><br><span class="line">t2.start(); <span class="comment">// t2 thread start</span></span><br><span class="line"></span><br><span class="line">t2.join(<span class="number">100</span>); <span class="comment">// 100ms 기다린 후에도 t2가 종료되지 않으면 다른 쓰레드 시작 </span></span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;C&quot;</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>interrupt()</code>를 이용한 대기 중지</p>
<ul>
<li>기존 동작을 방해하고 반응을 강제하는 메소드<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Thread tSleep = <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Interrupted&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">tSleep.start();</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    Thread.sleep(<span class="number">500</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">tSleep.interrupt();</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>yield()</code>를 이용한 상태 제어</p>
<ul>
<li><code>sleep()</code>과 달리 곧바로 <code>RUNNABLE</code> 상태로 변경</li>
<li>다른 쓰레드에게 양보하고 바로 실행 대기</li>
<li>테스트용으로 쓰임 -&gt; 쓰레드의 동작이 명확하지 않음(바로 양보하지 않는다)<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Thread.yield();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).start();</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">            System.out.print(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Thread.yield();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).start();</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>스레드의 종료</p>
<ul>
<li>run() 메소드의 종료</li>
<li><code>stop()</code> 메소드 호출 (deprecated)</li>
</ul>
</li>
</ul>
<h2 id="데몬-스레드"><a href="#데몬-스레드" class="headerlink" title="데몬 스레드"></a>데몬 스레드</h2><ul>
<li><p>정의 : 다른 스레드가 종료될 경우 함께 종료되는 보조 스레드</p>
</li>
<li><p>활용법</p>
<ul>
<li>보통 대기하며 동작하는 무한 루프로 구현</li>
<li>일정 시간 마다 동작</li>
<li>interrupt에 의해서 동작</li>
</ul>
</li>
<li><p><code>setDaemon()</code> 메소드로 데몬 스레드로 설정</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DaemonThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DaemonThread</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setDaemon(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;Daemon Thread Run&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="데이터-공유와-동기화"><a href="#데이터-공유와-동기화" class="headerlink" title="데이터 공유와 동기화"></a>데이터 공유와 동기화</h2><ul>
<li><p>스레드간 데이터 공유 시 신뢰성에 문제가 발생할 수 있음</p>
<p>  <code>결과는 1000000이 나오지 않는다 -&gt; count값이 동기화되지 않았기 때문</code></p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span></span>&#123;</span><br><span class="line">        Counter counter = <span class="keyword">new</span> Counter();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">1000</span>; j++) &#123;</span><br><span class="line">                    counter.count = counter.count + <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).start();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(counter.count);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>synchronized</code> 키워드 사용</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 공유 데이터 사용</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span>(sharedObj) &#123;</span><br><span class="line">        <span class="comment">// 공유 데이터 사용</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Example</p>
<ul>
<li><p>this 객체의 Intrinsic Lock을 이용한 구현</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">increaseCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> ++count; <span class="comment">// 읽고, 수정하고, 쓰는 작업</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>메소드에 synchronized 키워드 사용</p>
<ul>
<li>synchronized 키워드가 사용된 메소드를 호출하기 위해서는 해당 객체를 소유해야만 호출이 가능. 소유하지 못하면 Blocking<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">int</span> <span class="title">increaseCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++count; <span class="comment">// 읽고, 수정하고, 쓰는 작업</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><code>wait()</code>, <code>notify()</code>, <code>notifyAll()</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WorkObject</span> </span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">methodA</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          System.out.println(<span class="string">&quot;ThreadA의 methodA() 작업 실행&quot;</span>);</span><br><span class="line">          notify(); <span class="comment">// 일시정지 상태에 있는 ThreadB를 실행 대기상태로 만듬 </span></span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">              wait(); <span class="comment">// ThreadA를 일시 정지 상태로 만듬 </span></span><br><span class="line">          &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">              e.printStackTrace();</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  </span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">methodB</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          System.out.println(<span class="string">&quot;ThreadB의 methodB() 작업 실행&quot;</span>);</span><br><span class="line">          notify(); <span class="comment">// 일시정지 상태에 있는 ThreadA를 실행 대기상태로 만듬</span></span><br><span class="line">          <span class="keyword">try</span> &#123;</span><br><span class="line">              wait(); <span class="comment">// ThreadB를 일시 정지 상태로 만듬</span></span><br><span class="line">          &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">              e.printStackTrace();</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">ThreadA</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">      <span class="keyword">private</span> WorkObject workObject;</span><br><span class="line"></span><br><span class="line">      ThreadA(WorkObject workObject) &#123;</span><br><span class="line">          <span class="keyword">this</span>.workObject = workObject;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++) &#123;</span><br><span class="line">              workObject.methodA(); <span class="comment">// 공유객체의 methodA를 반복적으로 호출 </span></span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">ThreadB</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">      <span class="keyword">private</span> WorkObject workObject;</span><br><span class="line"></span><br><span class="line">      ThreadB(WorkObject workObject) &#123;</span><br><span class="line">          <span class="keyword">this</span>.workObject = workObject;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">          <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++) &#123;</span><br><span class="line">              workObject.methodB(); <span class="comment">// 공유객체의 methodA를 반복적으로 호출 </span></span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">          WorkObject sharedObject = <span class="keyword">new</span> WorkObject();</span><br><span class="line">          </span><br><span class="line">          ThreadA threadA = <span class="keyword">new</span> ThreadA(sharedObject);</span><br><span class="line">          ThreadB threadB = <span class="keyword">new</span> ThreadB(sharedObject);</span><br><span class="line">          </span><br><span class="line">          threadA.start();</span><br><span class="line">          threadB.start();</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="세마포어"><a href="#세마포어" class="headerlink" title="세마포어"></a>세마포어</h2><ul>
<li><p>사전적 의미 : 횟대(깃발)</p>
</li>
<li><p>n개의 깃발을 놓고, 여러 스레드가 경쟁하도록 하는 sync 기법</p>
</li>
<li><p>n = 1이면, BinarySemaphore라고 하며, Lock과 유사하게 동작</p>
</li>
<li><p>메소드</p>
<ul>
<li>release(int permits) : permits만큼의 자원 개수 반환</li>
<li>acquire(int permits) : permits만큼의 자원 사용 (Blocking O)</li>
<li>tryAcquire(long timeout, TimeUnit unit) : unit단위의 timeout이후 자원을 얻지 못하면 false, 얻으면 true (Blocking X)</li>
<li>acquireUninterruptibly() : 자원을 얻지못해도 interrupt 발생 X</li>
</ul>
</li>
<li><p>Example</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Semaphore sem = <span class="keyword">new</span> Semaphore(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        sem.release(<span class="number">10</span>);</span><br><span class="line">        sem.tryAcquire();</span><br><span class="line">        System.out.println(sem.availablePermits());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123; <span class="comment">// Blocking으로 동작</span></span><br><span class="line">            sem.acquire(<span class="number">12</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        sem.acquireUninterruptibly(); <span class="comment">// interrupt에 반응하지 않음</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(sem.tryAcquire(<span class="number">100</span>, TimeUnit.MILLISECONDS)); <span class="comment">// Blocking 하지 않고, 실패하면 false</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        sem.release();</span><br><span class="line"></span><br><span class="line">        System.out.println(sem.availablePermits());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
</li>
<li><p>Dining Philosopher (식사하는 철학자)</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Philosopher</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Fork left;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Fork right;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Philosopher</span><span class="params">(<span class="keyword">int</span> id, Fork left, Fork right)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.left = left;</span><br><span class="line">        <span class="keyword">this</span>.right = right;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                left.acquire();</span><br><span class="line">                System.out.println(id + <span class="string">&quot;: left taken&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(!right.tryAcquire(<span class="number">1000</span>, TimeUnit.MILLISECONDS))&#123;</span><br><span class="line">                    left.release();</span><br><span class="line">                    Thread.yield();</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(id + <span class="string">&quot;: right taken&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">                System.out.println(id + <span class="string">&quot;is eating&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            left.release();</span><br><span class="line">            right.release();</span><br><span class="line">            Thread.yield();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fork</span> <span class="keyword">extends</span> <span class="title">Semaphore</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Fork</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Philosopher[] phils = <span class="keyword">new</span> Philosopher[<span class="number">5</span>];</span><br><span class="line">        Fork[] forks = <span class="keyword">new</span> Fork[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            forks[i] = <span class="keyword">new</span> Fork();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span> - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            phils[i] = <span class="keyword">new</span> Philosopher(i, forks[i], forks[(i+<span class="number">1</span>) % <span class="number">5</span>]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        phils[<span class="number">4</span>] = <span class="keyword">new</span> Philosopher(<span class="number">4</span>, forks[<span class="number">0</span>], forks[<span class="number">4</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">            phils[i].start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="JCF와-Thread"><a href="#JCF와-Thread" class="headerlink" title="JCF와 Thread"></a>JCF와 Thread</h2><ul>
<li><p>Vector VS List</p>
<ul>
<li>List   <ul>
<li>메소드들이 Synchronized 되지 않음</li>
<li>속도는 빠르다.</li>
</ul>
</li>
<li>Vector <ul>
<li>메소드들이 Synchronized 되어 있음</li>
<li>속도는 느리다.</li>
</ul>
</li>
</ul>
</li>
<li><p>List를 Synchronized 되게 하는 방법</p>
<ul>
<li>Collections의 synchronizedList() 사용  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; list1 = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">List&lt;Integer&gt; list2 = Collections.synchronizedList(list1);</span><br></pre></td></tr></table></figure>
<h2 id="Thread-Pool"><a href="#Thread-Pool" class="headerlink" title="Thread Pool"></a>Thread Pool</h2></li>
</ul>
</li>
<li><p>Thread Pool이란?</p>
<ul>
<li>미리 생성해 둔 Thread의 집합을 스레드 풀이라고 한다.</li>
<li>미리 Thread를 생성해 두고, 작업만 Thread에 할당하여 동작</li>
<li>사용 이유<ul>
<li>Thread를 직접 만들어 사용할 경우, Multi-Thread 작업을 계속 할 때, Thread 생성/삭제 오버해드가 크다.</li>
<li>배치작업 (모아두고 한 번에 처리하는 작업)에 유용하여 많이 사용된다.</li>
</ul>
</li>
</ul>
</li>
<li><p>Thread Pool 생성 </p>
<ul>
<li><p>Single Thread Pool</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ExecutorService pool = Executors.newSingleThreadExecutor();</span><br></pre></td></tr></table></figure>
<ul>
<li>Thread가 1개인 ThreadPool 생성(SingleThread)</li>
<li>실패 시, 새로운 Thread를 생성하지 않음</li>
</ul>
</li>
<li><p>Cached Thread Pool</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ExecutorService pool = Executors.newCachedThreadPool();</span><br></pre></td></tr></table></figure>
<ul>
<li>초기 Thread 0개</li>
<li>코어 Thread 0개 (일하지 않아도 종료시키지 않는 Thread)</li>
<li>요청 작업보다 Thead가 부족하면 새 스레드 생성</li>
<li>60초동안 일하지 않는 Thread 제거</li>
</ul>
</li>
<li><p>Fixed Thread Pool</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ExecutorService pool = Executors.newFixedThreadPool(<span class="keyword">int</span> nThreads);</span><br></pre></td></tr></table></figure>
<ul>
<li>최대 Thread nThreads개</li>
<li>코어 Thread nThreads개</li>
<li>작업하지 않는 Thread도 제거하지 않고 동작</li>
</ul>
</li>
<li><p>Scheduler Thread Pool</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ScheduledExecutorService pool = Executors.newScheduledThreadPool(<span class="keyword">int</span> corePoolSize);</span><br></pre></td></tr></table></figure>
<ul>
<li>지정된 delay후에 실행하도록함(주기적으로 실행하는 명령을 예약)</li>
</ul>
</li>
</ul>
</li>
<li><p>작업 생성과 처리 요청</p>
<ul>
<li><p>작업 생성</p>
<ul>
<li><p>Runnable 구현 클래스</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Runnable task = <span class="keyword">new</span> Runnable()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 작업 내용</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Callable 구현 클래스</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Callable&lt;T&gt; task = <span class="keyword">new</span> Callable&lt;T&gt;()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">// 작업 내용</span></span><br><span class="line">        <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>  <code>Runnable run()은 Return 값이 없고, Callable call()은 Return 값이 있음</code></p>
</li>
</ul>
</li>
<li><p>처리 요청</p>
<ul>
<li><p>매소드 </p>
<table>
<thead>
<tr>
<th>리턴 타입</th>
<th>메소드</th>
<th>설명</th>
</tr>
</thead>
<tbody><tr>
<td>void</td>
<td>execute(Runnable command)</td>
<td>Runnable을 작업 큐에 저장, 작업 처리 결과를 받지 못함</td>
</tr>
<tr>
<td>Future&lt;?&gt;</td>
<td>submit(Runnable task)</td>
<td>Runnable 작업 큐에 저장, 리턴된 Future를 통해 작업 처리 결과를 얻을 수 있음</td>
</tr>
<tr>
<td>Future</td>
<td>submit(Runnable task, V result)</td>
<td>Runnable 작업 큐에 저장, 리턴된 Future를 통해 작업 처리 결과를 얻을 수 있음</td>
</tr>
<tr>
<td>Future</td>
<td>submit(Callable task)</td>
<td>Callable 작업 큐에 저장, 리턴된 Future를 통해 작업 처리 결과를 얻을 수 있음</td>
</tr>
</tbody></table>
<ul>
<li><p>execute()</p>
<ul>
<li><p>작업 처리 결과를 반환하지 않는다.</p>
</li>
<li><p>작업 처리 도중 예외가 발생하면 스레드가 종료되고 해당 스레드는 스레드 풀에서 제거된다. </p>
</li>
<li><p>다른 작업을 처리하기 위해 새로운 스레드를 생성한다.</p>
</li>
</ul>
</li>
<li><p>submit()</p>
<ul>
<li><p>작업 처리 결과를 반환한다.</p>
</li>
<li><p>작업 처리 도중 예외가 발생하더라도 스레드는 종료되지 않고 다음 작업을 위해 재사용</p>
</li>
<li><p>스레드의 생성 오버헤드를 방지하기 위해서라도 submit() 을 가급적 사용한다.</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Thread Pool 종료</p>
<blockquote>
<p>Thread Pool에 속한 Thread는 데몬 스레드가 아니다</p>
</blockquote>
<blockquote>
<p>따라서 주 스레드 종료시 강제종료 되지 않기 때문에 main 스레드가 종료되어도 실행상태가 유지된다.</p>
</blockquote>
<blockquote>
<p>어플리케이션을 종료하기 위해서는 스레드 풀을 강제종료시켜야 한다.</p>
</blockquote>
<ul>
<li><p>excutorService.shutdown()</p>
<p>  작업큐에 남아있는 작업까지 모두 마무리 후 종료 (오버헤드를 줄이기 위해 일반적으로 많이 사용.)</p>
</li>
<li><p>excutorService.shoutdownNow()</p>
<p>  작업큐 작업 잔량 상관없이 강제 종료</p>
</li>
<li><p>excutorService.awaitTermination(long timeout, TimeUnit unit)</p>
<p>  모든 작업 처리를 timeout 시간안에 처리하면 true 리턴 ,처리하지 못하면 작업스레드들을 interrupt()시키고 false리턴</p>
</li>
</ul>
</li>
</ul>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/Java/" rel="tag">Java</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2020/10/29/DATABASE-NoSQL-MongoDB/"
                    data-tooltip="DATABASE-NoSQL(MongoDB)"
                    aria-label="PREVIOUS: DATABASE-NoSQL(MongoDB)"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2020/10/27/Algorithm-%EB%AC%B8%EC%A0%9C%EC%A7%91/"
                    data-tooltip="Algorithm-문제집"
                    aria-label="NEXT: Algorithm-문제집"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://kimyechan.github.io/2020/10/28/Java-Advanced10-Multi-Thread/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://kimyechan.github.io/2020/10/28/Java-Advanced10-Multi-Thread/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://kimyechan.github.io/2020/10/28/Java-Advanced10-Multi-Thread/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 Yechan Kim. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2020/10/29/DATABASE-NoSQL-MongoDB/"
                    data-tooltip="DATABASE-NoSQL(MongoDB)"
                    aria-label="PREVIOUS: DATABASE-NoSQL(MongoDB)"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2020/10/27/Algorithm-%EB%AC%B8%EC%A0%9C%EC%A7%91/"
                    data-tooltip="Algorithm-문제집"
                    aria-label="NEXT: Algorithm-문제집"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://kimyechan.github.io/2020/10/28/Java-Advanced10-Multi-Thread/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://kimyechan.github.io/2020/10/28/Java-Advanced10-Multi-Thread/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://kimyechan.github.io/2020/10/28/Java-Advanced10-Multi-Thread/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://kimyechan.github.io/2020/10/28/Java-Advanced10-Multi-Thread/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://kimyechan.github.io/2020/10/28/Java-Advanced10-Multi-Thread/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=https://kimyechan.github.io/2020/10/28/Java-Advanced10-Multi-Thread/"
                        aria-label="Share on Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">Yechan Kim</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/jquery.js"></script>


<script src="/assets/js/jquery.fancybox.js"></script>


<script src="/assets/js/thumbs.js"></script>


<script src="/assets/js/tranquilpeak.js"></script>

<!--SCRIPTS END-->


    
        <script>
          var disqus_config = function() {
            this.page.url = 'https://kimyechan.github.io/2020/10/28/Java-Advanced10-Multi-Thread/';
              
            this.page.identifier = '2020/10/28/Java-Advanced10-Multi-Thread/';
              
          };
          (function() {
            var d = document, s = d.createElement('script');
            var disqus_shortname = 'xhandev';
            s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
    




    </body>
</html>
